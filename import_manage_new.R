## ----setup, include=FALSE--------------------------------------------------------------------------------
knitr::opts_chunk$set(echo = TRUE)


## --------------------------------------------------------------------------------------------------------

#setwd('C:\Users\admin\Documents\Lehre\Lehre FSS 19\Data')



## --------------------------------------------------------------------------------------------------------

setwd('C:/Users/admin/Documents/Lehre/Lehre FSS 19/Data')



## --------------------------------------------------------------------------------------------------------

# go UP in the tree
setwd("..")

#go down into a subdirectory


## --------------------------------------------------------------------------------------------------------

dir.create("files")

setwd("./files")



## --------------------------------------------------------------------------------------------------------
setwd("./files")
getwd()


## --------------------------------------------------------------------------------------------------------
getwd()


## --------------------------------------------------------------------------------------------------------

list.files()


## --------------------------------------------------------------------------------------------------------

#?read.table()



## --------------------------------------------------------------------------------------------------------
c1<-read.csv('presidential_national_toplines_2020.csv')



## --------------------------------------------------------------------------------------------------------

load('presidents.rdata')



## --------------------------------------------------------------------------------------------------------

save(c1,file='presidents.rdata')



## --------------------------------------------------------------------------------------------------------
r1<-readRDS('presidents.rds')



## --------------------------------------------------------------------------------------------------------

saveRDS(r1,file='presidents.rds')



## --------------------------------------------------------------------------------------------------------

if(!require(readstata13)){install.packages("readstata13")}




## --------------------------------------------------------------------------------------------------------


library(foreign)
library(readstata13)


list.files()
fr1<-read.dta13("ZA5861_v1-0-0.dta")
fr2<-read.spss("ZA5861_v1-0-0.sav",to.data.frame = T)


## --------------------------------------------------------------------------------------------------------

attributes(c1)


## --------------------------------------------------------------------------------------------------------
list.files()
c2<-read.csv("candidate_summary_2020.csv")

c2$Cand_Name
c2[,2]
c2[,1]
c2[,"Cand_Name"]


## --------------------------------------------------------------------------------------------------------
dems<-c2[c2$Cand_Party_Affiliation=="DEM",]
reps<-c2[c2$Cand_Party_Affiliation=="REP",]




## --------------------------------------------------------------------------------------------------------
lapply(dems,class)



## --------------------------------------------------------------------------------------------------------

c2$Party<-as.factor(c2$Cand_Party_Affiliation)
c2$Party


## --------------------------------------------------------------------------------------------------------
c2$Incumbent<-factor(c2$Cand_Incumbent_Challenger_Open_Seat,labels=c("C","I","O"))


## --------------------------------------------------------------------------------------------------------

table(c2$Cand_Incumbent_Challenger_Open_Seat)

c2$Incumbent<-factor(c2$Cand_Incumbent_Challenger_Open_Seat,labels=c("","C","I","O"))
                


## --------------------------------------------------------------------------------------------------------

any(is.na(c2$Incumbent))
any(c2$Incumbent=="")


## --------------------------------------------------------------------------------------------------------

c2$Incumbent<-ifelse(c2$Cand_Incumbent_Challenger_Open_Seat=="",NA,c2$Cand_Incumbent_Challenger_Open_Seat)

c2$Incumbent<-factor(c2$Incumbent,labels=c("C","I","O"))



## --------------------------------------------------------------------------------------------------------

class(c1$modeldate)
c1$modeldate<-as.Date(c1$modeldate,format="%m/%d/%Y")




## --------------------------------------------------------------------------------------------------------

ger_birthdate<-c("01.01.2010","15.02.2015","01.07.1995","01.11.2003")

#df$ger_birthdate<-as.Date(df$ger_birthdate)

ger_birthdate<-as.Date(ger_birthdate,format = "%d.%m.%Y") # day, month, year 

ger_birthdate



## --------------------------------------------------------------------------------------------------------

plot(c1$modeldate,c1$national_voteshare_inc)



## --------------------------------------------------------------------------------------------------------

plot(c1$modeldate,c1$national_voteshare_inc,type="lines",ylab="Voteshare",xlab="Time")



## --------------------------------------------------------------------------------------------------------

plot(c1$modeldate,c1$national_voteshare_inc,type="lines",ylim=c(44,55),ylab="Voteshare",xlab="Time")



## --------------------------------------------------------------------------------------------------------

plot(c1$modeldate,c1$national_voteshare_inc,type="lines",ylim=c(44,55),col="red",ylab="Voteshare",xlab="Time")
lines(c1$modeldate,c1$national_voteshare_chal,col="blue")




## --------------------------------------------------------------------------------------------------------
barplot(table(c2$Incumbent),col=c("red","blue","yellow"))



## --------------------------------------------------------------------------------------------------------
hist(c1$popwin_inc)



## --------------------------------------------------------------------------------------------------------

plot(log(c2$Total_Receipt)~c2$Incumbent)



## --------------------------------------------------------------------------------------------------------

mod<-lm(c2$Total_Receipt~(c2$Party=="DEM")+c2$Incumbent)




## --------------------------------------------------------------------------------------------------------

summary(mod)



## --------------------------------------------------------------------------------------------------------
frc<-read.csv("house_district_forecast.csv")


## --------------------------------------------------------------------------------------------------------
                      # this is a tilde!      
vs<-aggregate(voteshare~candidate,frc,FUN="mean")



## --------------------------------------------------------------------------------------------------------
                      # this is a tilde!      
vs<-aggregate(voteshare~candidate+party,frc,FUN="mean")



## --------------------------------------------------------------------------------------------------------
                      # this is a tilde!      
vs<-aggregate(voteshare~candidate+model,frc,FUN="mean")



## --------------------------------------------------------------------------------------------------------
library(reshape2)

d1<-reshape2::dcast(frc, candidate ~ model,fun=mean, value.var="voteshare",)




## --------------------------------------------------------------------------------------------------------
library(lubridate)

# first we round the date to make it
frc$week<-round_date(frc$forecastdate,"week")

d2<-reshape2::dcast(frc, candidate ~ week,fun=mean, value.var="voteshare",)



## --------------------------------------------------------------------------------------------------------
d4<-reshape2::melt(d2)



## --------------------------------------------------------------------------------------------------------

c1<-read.csv("congress1.csv")

names(c1)



## --------------------------------------------------------------------------------------------------------

c2<-merge(c1,frc,by="candidate")



## --------------------------------------------------------------------------------------------------------

c2<-merge(c1,frc,by="candidate",all.y=T)



## --------------------------------------------------------------------------------------------------------

c2<-merge(c1,frc,by.y="candidate",by.x="name",all.y=T)


